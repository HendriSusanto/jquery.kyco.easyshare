/*
**
**  jquery.kyco.easyshare
**  =====================
**
**  Version 1.2.0
**
**  Brought to you by
**  https://www.kycosoftware.com
**
**  Copyright 2015 Cornelius Weidmann
**
**  Distributed under the GPL
**
*/

var kyco=kyco||{};kyco.API_PATH="../api/easyshare.php";
kyco.easyShare=function(){if(0<$("[data-easyshare]").length){var a=[];$("[data-easyshare]").each(function(b,c){a[b]={};a[b].self=$(this);a[b].url=a[b].self.data("easyshare-url");a[b].countTotal=a[b].self.find("[data-easyshare-total-count]");a[b].countFacebook=a[b].self.find('[data-easyshare-button-count="facebook"]');a[b].countTwitter=a[b].self.find('[data-easyshare-button-count="twitter"]');a[b].countGoogle=a[b].self.find('[data-easyshare-button-count="google"]');a[b].loader=a[b].self.find("[data-easyshare-loader]");a[b].FORCE_HTTP="undefined"!==typeof a[b].self.data("easyshare-http")?!0:!1;a[b].FORCE_HTTPS="undefined"!==typeof a[b].self.data("easyshare-https")?!0:!1;a[b].SHARE_URL="undefined"===typeof a[b].url||""===a[b].url?window.location.href:a[b].url;$.ajax({url:kyco.API_PATH,type:"GET",data:{url:a[b].SHARE_URL,http:a[b].FORCE_HTTP,https:a[b].FORCE_HTTPS},dataType:"json",success:function(d){a[b].countTotal.html(kyco.easyShareApproximate(d.Total));a[b].countFacebook.html(kyco.easyShareApproximate(d.Facebook));a[b].countTwitter.html(kyco.easyShareApproximate(d.Twitter));a[b].countGoogle.html(kyco.easyShareApproximate(d.Google))},error:function(){a[b].countTotal.html(0);a[b].countFacebook.html(0);a[b].countTwitter.html(0);a[b].countGoogle.html(0)},complete:function(){a[b].loader.fadeOut(500)}});a[b].self.find('[data-easyshare-button="facebook"]').click(function(){var a=($(window).width()-500)/2,b=($(window).height()-400)/2;window.open("https://www.facebook.com/sharer/sharer.php?u="+SHARE_URL,"facebook","width=500,height=400,top="+b+",left="+a)});a[b].self.find('[data-easyshare-button="twitter"]').click(function(){var a=$(this).data("easyshare-tweet-text")||"",b=($(window).width()-575)/2,c=($(window).height()-440)/2,a="https://twitter.com/share?text="+encodeURIComponent(a);window.open(a,"twitter","status=1,width=575,height=440,top="+c+",left="+b)});a[b].self.find('[data-easyshare-button="google"]').click(function(){var a=($(window).width()-500)/2,b=($(window).height()-400)/2;window.open("https://plus.google.com/share?url="+SHARE_URL,"google+","width=500,height=400,top="+b+",left="+a)})})}};kyco.easyShareAddCommas=function(a){var b=[],c=Math.round(a).toString().split("");if(1E3>a)return a.toString();c.reverse().forEach(function(a,c){c&&0===c%3&&b.push(",");b.push(a)});return b.reverse().join("")};kyco.easyShareFormatDecimals=function(a,b){var c=a/b;return 10>c?Math.round(10*c)/10:Math.round(c)};kyco.easyShareApproximate=function(a){var b=0>a;b&&(a=Math.abs(a));a=1E4>a?kyco.easyShareAddCommas(a):1E6>a?kyco.easyShareFormatDecimals(a,1E3)+"k":1E9>a?kyco.easyShareFormatDecimals(a,1E6)+"m":kyco.easyShareAddCommas(kyco.easyShareFormatDecimals(a,1E9))+"b";b&&(a="-"+a);return a};$(document).ready(function(){kyco.easyShare()});
